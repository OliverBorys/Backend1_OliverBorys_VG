<div class="modal-backdrop" (click)="close.emit()">
  <div class="modal-box" (click)="$event.stopPropagation()">
    <div class="modal-content">
      <h2 class="modal-title">
        {{ product ? 'Edit Product' : 'Add New Product' }}
      </h2>
      <div class="form-section">
        <form [formGroup]="form" (ngSubmit)="submit()" class="form-grid">
          <div class="form-group">
            <input formControlName="productName" placeholder="Product Name" maxlength="25" />
            @if (form.get('productName')?.touched && form.get('productName')?.invalid) {
            <div class="error-message">Product Name is required.</div>
            }
          </div>

          <div class="form-group">
            <input formControlName="brand" placeholder="Brand" />
            @if (form.get('brand')?.touched && form.get('brand')?.invalid) {
            <div class="error-message">Brand is required.</div>
            }
          </div>

          <div class="form-group">
            <select formControlName="categoryId">
              <option value="" disabled>Select Category</option>
              @for (cat of categories; track cat) {
              <option [value]="cat.id">
                {{ cat.categoryName }}
              </option>
              }
            </select>
            @if (form.get('categoryId')?.touched && form.get('categoryId')?.invalid) {
            <div class="error-message">Category is required.</div>
            }
          </div>

          <div class="form-group">
            <label for="price">Price:</label>
            <input formControlName="price" type="number" />
            @if (form.get('price')?.touched && form.get('price')?.invalid) {
            <div class="error-message">
              @if (form.get('price')?.errors?.['required']) {
              <div>Price is required.</div>
              } @if (form.get('price')?.errors?.['min']) {
              <div>Price must be at least 0.</div>
              }
            </div>
            }
          </div>

          <div class="form-group">
            <label>Images:</label>
            <input type="file" accept="image/*" (change)="onFileChange($event, 'image')" />
          </div>
          <div class="form-group">
            <input
              type="file"
              accept="image/*"
              (change)="onFileChange($event, 'secondaryImage1')"
            />
          </div>
          <div class="form-group">
            <input
              type="file"
              accept="image/*"
              (change)="onFileChange($event, 'secondaryImage2')"
            />
          </div>
          <div class="form-group">
            <input
              type="file"
              accept="image/*"
              (change)="onFileChange($event, 'secondaryImage3')"
            />
          </div>

          <div class="form-group">
            <textarea formControlName="productDescription" placeholder="Description"></textarea>
            @if (form.get('productDescription')?.touched && form.get('productDescription')?.invalid)
            {
            <div class="error-message">Description is required.</div>
            }
          </div>

          <div class="is-new-date">
            <div class="new">
              <input type="checkbox" formControlName="isTrending" id="isTrending" />
              <label for="isTrending">Trending</label>
            </div>
            <div class="form-group date">
              <input type="date" formControlName="publishingDate" class="date" />
              @if (form.get('publishingDate')?.touched && form.get('publishingDate')?.invalid) {
              <div class="error-message">Publishing Date is required.</div>
              }
            </div>
          </div>

          <div class="modal-actions">
            <button type="button" (click)="close.emit()">Cancel</button>
            <button type="submit" [disabled]="!form.valid">
              {{ product ? 'Update' : 'Add Product' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
