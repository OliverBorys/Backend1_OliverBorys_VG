<h2 class="admin-title">Category Management</h2>

<section class="admin-products-table">
  <div class="toolbar">
    <div class="spacer"></div>
    <button class="add-btn" (click)="openAddModal()">+ Add Category</button>
  </div>

  @if (loading) {
    <div class="loading">Loading…</div>
  }
  @if (!loading && categories.length === 0) {
    <div class="no-products">No categories found.</div>
  }

  @if (!loading && categories.length > 0) {
    <table class="product-table">
      <thead>
        <tr>
          <th class="small">ID</th>
          <th class="medium">Image</th>
          <th>Category</th>
          <th class="small">Products</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (c of categories; track c) {
          <tr>
            <td class="small">{{ c.id }}</td>
            <td class="medium">
              @if (c.imageUrl) {
                <img [src]="c.imageUrl" alt="{{ c.categoryName }}" class="product-thumbnail" />
              } @else {
                <span class="muted">—</span>
              }
            </td>
            <td class="product-cell">
              <span>{{ c.categoryName }}</span>
            </td>
            <td class="small">{{ c.productCount }}</td>
            <td class="actions">
              <button class="edit-btn" (click)="openEditModal(c)">Edit</button>
              <button class="delete-btn" (click)="openDeleteModal(c)">Delete</button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  }
</section>

@if (showForm) {
  <app-category-form
    [open]="showForm"
    [category]="selectedCategory"
    (save)="handleSave($event)"
    (close)="closeForm()"
  ></app-category-form>
}

@if (showDeleteModal) {
  <app-confirm-delete-modal
    [itemName]="categoryToDelete?.categoryName || ''"
    (confirm)="confirmDelete()"
    (close)="closeDeleteModal()"
  ></app-confirm-delete-modal>
}
