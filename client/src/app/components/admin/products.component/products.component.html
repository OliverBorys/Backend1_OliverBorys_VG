<h2 class="admin-title">Product Management</h2>
<section class="admin-products-table">
  <div class="toolbar">
    <input
      type="text"
      class="search-input"
      placeholder="Search product..."
      [(ngModel)]="searchQuery"
    />
    <button class="add-btn" (click)="openAddModal()">+ Add Product</button>
  </div>

  <table class="product-table">
    <thead>
      <tr>
        <th class="small" (click)="setSort('id')">
          ID @if (sortColumn === 'id') {
          <span>{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
          }
        </th>
        <th (click)="setSort('productName')">
          Product @if (sortColumn === 'productName') {
          <span>{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
          }
        </th>
        <th class="small" (click)="setSort('categoryName')">
          Category @if (sortColumn === 'categoryName') {
          <span>{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
          }
        </th>
        <th class="medium" (click)="setSort('price')">
          Price @if (sortColumn === 'price') {
          <span>{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
          }
        </th>
        <th class="medium" (click)="setSort('isTrending')">
          Trending @if (sortColumn === 'isTrending') {
          <span>{{ sortDirection === 'asc' ? '▲' : '▼' }}</span>
          }
        </th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      @for (product of filteredProducts; track product) {
      <tr>
        <td class="small">{{ product.id }}</td>
        <td class="product-cell">
          <img [src]="product.image" alt="{{ product.productName }}" class="product-thumbnail" />
          <span>{{ product.productName }}</span>
        </td>
        <td class="small">{{ product.categoryName }}</td>
        <td class="medium">${{ product.price.toFixed(2) }}</td>
        <td class="medium">
          <span [ngClass]="{ tag: true, new: product.isTrending === 'yes' }">
            {{ product.isTrending === 'yes' ? 'Yes' : 'No' }}
          </span>
        </td>
        <td class="actions">
          <button class="edit-btn" (click)="openEditModal(product)">Edit</button>
          <button class="delete-btn" (click)="openDeleteModal(product)">Delete</button>
        </td>
      </tr>
      }
    </tbody>
  </table>
</section>

@if (showModal) {
<app-product-form
  [product]="selectedProduct"
  [categories]="categories"
  (save)="handleSave($event)"
  (close)="closeModal()"
></app-product-form>
} @if (showDeleteModal) {
<app-confirm-delete-modal
  [itemName]="productToDelete?.productName || ''"
  (confirm)="confirmDelete()"
  (close)="closeDeleteModal()"
></app-confirm-delete-modal>
}
