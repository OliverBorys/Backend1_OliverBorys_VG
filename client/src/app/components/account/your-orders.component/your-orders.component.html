<h2 class="orders-title">Your Orders</h2>

@if (loading) {
  <div class="loading">Loading your orders…</div>
}
@if (!loading && errorMsg) {
  <div class="error">{{ errorMsg }}</div>
}
@if (!loading && !errorMsg && orders.length === 0) {
  <div class="no-orders">
    You don’t have any orders yet.
  </div>
}

@for (order of orders; track order) {
  <div class="order-card">
    <div class="order-header">
      <div>
        <h3>Order #{{ order.id }}</h3>
        <p class="muted">Date: {{ order.createdAt | date: 'medium' }}</p>
      </div>
      <div class="pill">
        Paid with: <strong>{{ order.paymentMethod || '—' }}</strong>
      </div>
    </div>
    <div class="order-columns">
      @if (profile) {
        <div class="order-customer">
          <h4>Customer</h4>
          <ul>
            <li>{{ profile.firstName }} {{ profile.lastName }}</li>
            <li>{{ profile.email }}</li>
            <li>{{ profile.mobilePhone }}</li>
            <li>
              {{ profile.address }}@if (profile.address && profile.city) {
              <span>,</span>
            }
            {{ profile.city }}
            @if (profile.city && profile.postalCode) {
              <span>,</span>
            }
            {{ profile.postalCode }}
          </li>
        </ul>
      </div>
    }
    <div class="order-items">
      <h4>Items</h4>
      <ul class="items-list">
        @for (it of order.items; track it) {
          <li class="item-row">
            @if (it.image) {
              <img
                [ngSrc]="it.image"
                width="56"
                height="56"
                class="thumb"
                alt="{{ it.productName }}"
                />
            }
            <div class="item-main">
              <div class="name">{{ it.productName }}</div>
              <div class="meta">
                {{ it.quantity }} × {{ asCurrency(it.unitPrice) }}
              </div>
            </div>
            <div class="line-total">{{ asCurrency(it.lineTotal) }}</div>
          </li>
        }
      </ul>
      <div class="order-total">
        <span>Total</span>
        <strong>{{ asCurrency(order.total) }}</strong>
      </div>
    </div>
  </div>
</div>
}
