<h2 class="account-title">Your account</h2>

<section class="account">
  <div class="card">
    <div class="card-header">
      <h2>Contact details</h2>
    </div>

    <form [formGroup]="profileForm" class="grid">
      <div class="row-two">
        <div class="field">
          <label>First name</label>
          <input formControlName="firstName" type="text" />
        </div>
        <div class="field">
          <label>Last name</label>
          <input formControlName="lastName" type="text" />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Email</label>
          <input formControlName="email" type="email" />
          @if (pf.email.touched && pf.email.invalid) {
            <small class="error">
              Invalid email
            </small>
          }
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Phonenumber</label>
          <input formControlName="mobilePhone" type="tel" />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Address</label>
          <input formControlName="address" type="text" />
        </div>
      </div>

      <div class="row-two">
        <div class="field">
          <label>City</label>
          <input formControlName="city" type="text" />
        </div>
        <div class="field">
          <label>Postalcode</label>
          <input formControlName="postalCode" type="text" />
        </div>
      </div>

      <div class="actions">
        <button type="button" (click)="saveProfile()" [disabled]="savingProfile">
          {{ savingProfile ? 'Saving...' : 'Save' }}
        </button>
        @if (profileMessage) {
          <span class="hint">{{ profileMessage }}</span>
        }
      </div>
    </form>
  </div>

  <div class="card">
    <div class="card-header">
      <h2>Change username</h2>
      <p>At least 3 characters. Has to be uniqe.</p>
    </div>

    <form [formGroup]="usernameForm" class="grid">
      <div class="row">
        <div class="field">
          <label>New username</label>
          <input formControlName="username" type="text" />
          @if (uf.username.touched && uf.username.invalid) {
            <small class="error">
              At least 3 characters
            </small>
          }
        </div>
      </div>

      <div class="actions">
        <button type="button" (click)="updateUsername()" [disabled]="savingUsername">
          {{ savingUsername ? 'Saving...' : 'Update username' }}
        </button>
        @if (usernameMessage) {
          <span class="hint">{{ usernameMessage }}</span>
        }
      </div>
    </form>
  </div>

  <div class="card">
    <div class="card-header">
      <h2>Change password</h2>
      <p>At least 6 characters.</p>
    </div>

    <form [formGroup]="passwordForm" class="grid">
      <div class="row">
        <div class="field">
          <label>Current password</label>
          <input formControlName="currentPassword" type="password" />
          @if (pwf.currentPassword.touched && pwf.currentPassword.invalid) {
            <small class="error">
              Required
            </small>
          }
        </div>
      </div>

      <div class="row-two">
        <div class="field">
          <label>New password</label>
          <input formControlName="newPassword" type="password" />
          @if (pwf.newPassword.touched && pwf.newPassword.invalid) {
            <small class="error">
              At least 6 characters
            </small>
          }
        </div>
        <div class="field">
          <label>Comfirm new password</label>
          <input formControlName="confirmNewPassword" type="password" />
          @if (passwordForm.errors?.['mismatch'] && pwf.confirmNewPassword.touched) {
            <small class="error"
              >
              Password does not match
            </small>
          }
        </div>
      </div>

      <div class="actions">
        <button type="button" (click)="updatePassword()" [disabled]="savingPassword">
          {{ savingPassword ? 'Saving...' : 'Update password' }}
        </button>
        @if (passwordMessage) {
          <span class="hint">{{ passwordMessage }}</span>
        }
      </div>
    </form>
  </div>
</section>
